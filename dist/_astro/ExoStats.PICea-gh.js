import{j as f}from"./jsx-runtime.D_zvdyIk.js";import{r as l}from"./index.CQ95-tCy.js";import{g as O,a as K,d as Q,L as R,D as W}from"./translations.p4xl-p1H.js";import{f as X}from"./fetchCSV.DjmYkm7D.js";import{i as Y,f as J,a as P,J as Z,u as B,M as q,b as ee,c as te,d as ne,e as T,r as re,m as N}from"./proxy.CMJzDI2N.js";import"./csv.DMq-eBQM.js";function se(...e){const t=!Array.isArray(e[0]),n=t?0:-1,s=e[0+n],r=e[1+n],g=e[2+n],d=e[3+n],p=Y(r,g,d);return t?p(s):p}function ie(e,t,n){const s=e.get();let r=null,g=s,d;const p=typeof s=="string"?s.replace(/[\d.-]/g,""):void 0,h=()=>{r&&(r.stop(),r=null)},b=()=>{h(),r=new Z({keyframes:[_(e.get()),_(g)],velocity:e.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...n,onUpdate:d})};if(e.attach((a,u)=>(g=a,d=y=>u(U(y,p)),J.postRender(b),e.get()),h),P(t)){const a=t.on("change",y=>e.set(U(y,p))),u=e.on("destroy",a);return()=>{a(),u()}}return h}function U(e,t){return t?e+t:e}function _(e){return typeof e=="number"?e:parseFloat(e)}function F(e){const t=B(()=>ee(e)),{isStatic:n}=l.useContext(q);if(n){const[,s]=l.useState(e);l.useEffect(()=>t.on("change",s),[])}return t}function $(e,t){const n=F(t()),s=()=>n.set(t());return s(),te(()=>{const r=()=>J.preRender(s,!1,!0),g=e.map(d=>d.on("change",r));return()=>{g.forEach(d=>d()),ne(s)}}),n}function oe(e){T.current=[],e();const t=$(T.current,e);return T.current=void 0,t}function ae(e,t,n,s){if(typeof e=="function")return oe(e);const r=se(t,n,s);return Array.isArray(e)?z(e,r):z([e],([g])=>r(g))}function z(e,t){const n=B(()=>[]);return $(e,()=>{n.length=0;const s=e.length;for(let r=0;r<s;r++)n[r]=e[r].get();return t(n)})}function ce(e,t={}){const{isStatic:n}=l.useContext(q),s=()=>P(e)?e.get():e;if(n)return ae(s);const r=F(s());return l.useInsertionEffect(()=>ie(r,e,t),[r,JSON.stringify(t)]),r}const le={some:0,all:1};function ue(e,t,{root:n,margin:s,amount:r="some"}={}){const g=re(e),d=new WeakMap,p=b=>{b.forEach(a=>{const u=d.get(a.target);if(a.isIntersecting!==!!u)if(a.isIntersecting){const y=t(a.target,a);typeof y=="function"?d.set(a.target,y):h.unobserve(a.target)}else typeof u=="function"&&(u(a),d.delete(a.target))})},h=new IntersectionObserver(p,{root:n,rootMargin:s,threshold:typeof r=="number"?r:le[r]});return g.forEach(b=>h.observe(b)),()=>h.disconnect()}function de(e,{root:t,margin:n,amount:s,once:r=!1,initial:g=!1}={}){const[d,p]=l.useState(g);return l.useEffect(()=>{if(!e.current||r&&d)return;const h=()=>(p(!0),r?void 0:()=>p(!1)),b={root:t&&t.current||void 0,margin:n,amount:s};return ue(e.current,h,b)},[t,e,n,r,s]),d}function me({to:e,from:t=0,direction:n="up",delay:s=0,duration:r=2,className:g="",startWhen:d=!0,separator:p,locale:h="en-US",onStart:b,onEnd:a}){const u=l.useRef(null),y=F(n==="down"?e:t),L=20+40*(1/r),D=100*(1/r),x=ce(y,{damping:L,stiffness:D}),E=de(u,{once:!0,margin:"0px"}),A=j=>{const k=j.toString();if(k.includes(".")){const S=k.split(".")[1];if(parseInt(S)!==0)return S.length}return 0},V=Math.max(A(t),A(e));return l.useEffect(()=>{u.current&&(u.current.textContent=String(n==="down"?e:t))},[t,e,n]),l.useEffect(()=>{if(E&&d){typeof b=="function"&&b();const j=setTimeout(()=>{y.set(n==="down"?t:e)},s*1e3),k=setTimeout(()=>{typeof a=="function"&&a()},s*1e3+r*1e3);return()=>{clearTimeout(j),clearTimeout(k)}}},[E,d,y,n,t,e,s,b,a,r]),l.useEffect(()=>{const j=x.on("change",k=>{if(u.current){const S=V>0,M={useGrouping:!!p,minimumFractionDigits:S?V:0,maximumFractionDigits:S?V:0};u.current.textContent=new Intl.NumberFormat(h,M).format(k)}});return()=>j()},[x,V,h]),f.jsx("span",{className:g,ref:u})}const G=e=>{const t=Number(e);return Number.isFinite(t)?t:null},pe=e=>{const t=G(e.pl_eqt),n=G(e.pl_insol),s=t!=null&&t>=180&&t<=310,r=n!=null&&n>=.25&&n<=1.5;return s||r};function we({src:e="/exoplanets.csv",lang:t=W,messages:n}){const[s,r]=l.useState(null),[g,d]=l.useState(null),p=O(t),[h,b]=l.useState(p),a=l.useMemo(()=>n&&h===p?n:K(h).stats,[h,n,p]);l.useEffect(()=>{const i=Q(p);b(c=>c===i?c:i);const o=c=>{const m=O(c.detail?.lang);b(m)};return window.addEventListener(R,o),()=>window.removeEventListener(R,o)},[p]),l.useEffect(()=>{const i=new AbortController;return(async()=>{try{const o=await X(e,{signal:i.signal});r(Array.isArray(o)?o:[])}catch(o){o.name!=="AbortError"&&d(o)}})(),()=>i.abort()},[e]);const u=l.useMemo(()=>{if(!s)return null;const i=s.length,o=new Set,c=new Map;let m=0;for(const C of s){const I=C.hostname;I&&(o.add(I),c.set(I,(c.get(I)??0)+1)),pe(C)&&m++}const w=o.size;let v=0;for(const[,C]of c)C>=2&&v++;return{total:i,systems:w,multiSystems:v,tempered:m}},[s]),{ariaLabel:y,heading:L,intro:D,cards:x}=a,E=l.useMemo(()=>[{id:"planets",kicker:x.planets.kicker,value:u?.total??0,title:x.planets.title,description:x.planets.description},{id:"systems",kicker:x.systems.kicker,value:u?.systems??0,title:x.systems.title,description:x.systems.description},{id:"multi",kicker:x.multi.kicker,value:u?.multiSystems??0,title:x.multi.title,description:x.multi.description},{id:"tempered",kicker:x.tempered.kicker,value:u?.tempered??0,title:x.tempered.title,description:x.tempered.description}],[x,u]),[A,V]=l.useState(E.map(i=>i.id));l.useEffect(()=>{const i=E.map(o=>o.id);V(o=>{const c=o.filter(w=>i.includes(w)),m=i.filter(w=>!c.includes(w));return[...c,...m]})},[E]);const j=(i,o)=>{V(c=>{const m=[...c],w=m.indexOf(i),v=m.indexOf(o);return w===-1||v===-1?c:([m[w],m[v]]=[m[v],m[w]],m)})},[k,S]=l.useState(null);if(g)return f.jsxs(N.section,{className:"glass card",style:{padding:"1rem"},initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{duration:.4,ease:[.16,1,.3,1]},children:[a.errorPrefix,": ",String(g)]});if(!u)return f.jsx(N.section,{className:"glass card",style:{padding:"1rem"},initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{duration:.4,ease:[.16,1,.3,1]},children:a.loading});const M=i=>i==null?0:i<1e3?i:Math.round(i/100)*100,H=({kicker:i,value:o,title:c,description:m,featured:w=!1})=>{const v=M(o);return f.jsxs("article",{className:`glass card stat ${w?"featured":""}`,children:[f.jsx("div",{className:"kicker",children:i}),f.jsx("div",{className:"big",children:o==null?"—":f.jsxs(f.Fragment,{children:[f.jsx(me,{to:v,duration:2,locale:h}),"+"]})}),f.jsx("h3",{style:{margin:".25rem 0 .35rem"},children:c}),f.jsx("p",{className:"subtitle",children:m})]})};return f.jsxs(N.section,{"aria-label":y,style:{marginTop:"1rem"},initial:{opacity:0,y:32},whileInView:{opacity:1,y:0},viewport:{once:!0,margin:"-10% 0px"},transition:{duration:.75,ease:[.16,1,.3,1]},children:[f.jsx("h2",{style:{textAlign:"center",margin:"0 0 .5rem"},children:L}),f.jsx("p",{className:"subtitle",style:{textAlign:"center",margin:"0 0 1rem"},children:D}),f.jsx("div",{className:"bento-grid",role:"list",children:A.map((i,o)=>{const c=E.find(m=>m.id===i);return c?f.jsx(N.div,{role:"listitem",className:"bento-item glass",draggable:!0,onDragStart:()=>S(i),onDragOver:m=>m.preventDefault(),onDrop:()=>k&&j(k,i),onDragEnd:()=>S(null),"aria-grabbed":k===i,title:"Arrastra para reordenar",initial:{opacity:0,y:24},whileInView:{opacity:1,y:0},viewport:{once:!0,margin:"-15% 0px"},transition:{duration:.55,delay:.1+o*.05,ease:[.16,1,.3,1]},children:f.jsx(H,{kicker:c.kicker,value:c.value,title:c.title,description:c.description,featured:o===0})},i):null})}),f.jsx("style",{children:`
        .bento-grid{ display:grid; gap:.75rem; grid-template-columns:repeat(4,minmax(0,1fr)); }
        .bento-item{ border-radius:16px; cursor: grab; }
        .bento-item:active{ cursor: grabbing; }
        /* Patrón Bento: posición depende del orden visual */
        @media (min-width:1024px){
          .bento-item:nth-child(1){ grid-column:span 2; grid-row:span 2; }
          .bento-item:nth-child(2){ grid-column:span 1; grid-row:span 1; }
          .bento-item:nth-child(3){ grid-column:span 1; grid-row:span 1; }
          .bento-item:nth-child(4){ grid-column:span 2; }
        }
        @media (max-width:1023px){ .bento-grid{ grid-template-columns:repeat(2,minmax(0,1fr)); } }
        @media (max-width:640px){ .bento-grid{ grid-template-columns:1fr; } }

        .stat { text-align:center; padding:1.25rem; position:relative; height:100%; }
        .stat.featured{ display:flex; flex-direction:column; justify-content:center; align-items:center; padding:2rem; overflow:hidden; }
        .stat.featured .big{ font-size: clamp(2.4rem, 6.5vw, 3.6rem); }
        .stat.featured::before{ content:""; position:absolute; inset:auto; width:380px; height:380px; border-radius:50%; right:-140px; top:-140px; background: radial-gradient(closest-side, rgba(137,180,255,.25), rgba(137,180,255,.12) 50%, transparent 70%); filter: blur(12px); pointer-events:none; }
        .stat.featured::after{ content:""; position:absolute; width: 120px; height: 120px; left: -50px; bottom: -50px; border-radius: 50%; background: radial-gradient(circle, rgba(255,255,255,.08), transparent 70%); filter: blur(6px); pointer-events:none; }
        .kicker{
          display:inline-block; padding:.35rem .6rem; border-radius:999px;
          border:1px solid var(--glass-brd); background:rgba(255,255,255,.06);
          margin-bottom:.5rem;
          box-shadow: 0 0 30px rgba(137,180,255,.25), inset 0 1px 0 rgba(255,255,255,.05);
        }
        .big{
          font-weight:900; font-size: clamp(1.8rem, 5.5vw, 2.6rem);
          letter-spacing:.5px; margin:.1rem 0;
          background:linear-gradient(180deg, #e6eaff 0%, #b7c0e6 100%);
          -webkit-background-clip:text; background-clip:text; color:transparent;
          text-shadow: 0 0 32px rgba(137,180,255,.15);
        }
      `})]})}export{we as default};
